id: directory-listing-enabled

info:
  name: Directory Listing Enabled
  author: alpha-suite
  severity: low
  description: |
    Directory listing is enabled on the web server, potentially exposing
    sensitive files and directory structure to attackers.
  reference:
    - https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/04-Review_Old_Backup_and_Unreferenced_Files_for_Sensitive_Information
  classification:
    cwe-id: CWE-548
  tags: misconfig,exposure,apache,nginx,iis

http:
  - method: GET
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/images/"
      - "{{BaseURL}}/assets/"
      - "{{BaseURL}}/uploads/"
      - "{{BaseURL}}/static/"
      - "{{BaseURL}}/css/"
      - "{{BaseURL}}/js/"
      - "{{BaseURL}}/backup/"

    stop-at-first-match: true
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "Index of /"
          - "Directory listing for"
          - "<title>Directory Listing"
          - "Parent Directory"
          - "[To Parent Directory]"
        condition: or

      - type: regex
        regex:
          - '<a href="[^"]*">[^<]+</a>\s*\d{2}-[A-Za-z]{3}-\d{4}'
          - 'Directory of'

    extractors:
      - type: regex
        part: body
        regex:
          - '<a href="([^"]+)">'
